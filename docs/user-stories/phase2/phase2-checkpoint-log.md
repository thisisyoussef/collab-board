# Phase II Checkpoint Log

| Story | Commit | Frontend URL | Socket URL | Local Validation | TDD Evidence | User Checkpoint | Status | Notes |
|---|---|---|---|---|---|---|---|---|
| US2-00 | Uncommitted | N/A (docs-only) | N/A (docs-only) | lint pass, test pass (20 files/144 tests), build pass (Node 18 warning only) | All stories include explicit failing-test plans and red->green->refactor flow | Pending | Ready for User Checkpoint | Phase II stories expanded with richer persona/user-story narratives, mandatory preparation phase (local + official web research), reusable template/authoring guide, and completed US2-00 preparation notes with official source links dated February 18, 2026. |
| US2-01 | Uncommitted | https://collab-board-iota.vercel.app | https://collab-board-0948.onrender.com | lint pass, targeted tests pass (19), full test pass (22 files/152 tests), build pass (Node warning only) | Added failing tests first for component/hook/board integration, then implemented until green | Passed | Approved | Right-sidebar AI command center shipped with prompt submit, retry/clear, preview list rendering, mode persistence, and disabled apply shell for US2-03. Deployed to Vercel production alias via deployment `dpl_E9gag6FMEwCJ1eeovH7h2AszFfUz` on February 18, 2026. Manual checkpoint passed. |
| US2-02 | Uncommitted | https://collab-board-iota.vercel.app | https://collab-board-0948.onrender.com | lint pass, targeted object/viewport suites pass, full test pass (26 files/166 tests), build pass (Node warning only) | Added failing tests first for object-model helpers, realtime merge rules, board v2 tool controls, and viewport persistence, then implemented to green | Pending | Ready for User Checkpoint | Added core primitives (`circle`, `line`, `text`, `frame`, `connector`), connector endpoint recompute on linked-object moves, and per-board/user viewport restore after refresh/reopen. Fix-forward added Figma-style connector endpoint handles (free drag + snap/attach anchors), visible shape anchor-point guides while connector editing is active, easier re-selection via expanded connector hit target, point-A to point-B connector drag creation (with snap-to-shape start and free-space endpoints), immediate pointer-follow endpoint detach behavior, and strict circle geometry normalization so circles cannot morph into pill/rounded-rectangle states. Deployed via `823jChhAVHbYq5S3kspVJcMUrXSV` on February 18, 2026 and aliased to `https://collab-board-iota.vercel.app`. |
| US2-03 | Uncommitted | https://collab-board-iota.vercel.app | https://collab-board-0948.onrender.com | lint pass, targeted US2-03 suites pass, full test pass (28 files/179 tests), build pass (Node warning only) | Added failing tests first for executor ordering/rollback, undo transaction behavior, AI panel apply/undo controls, generic plan-quality self-correction behavior, malformed-plan correction behavior, undo-disable UX behavior after manual invalidation, and socket cold-start wake handling, then implemented to green | Pending | Ready for User Checkpoint | Shipped transactional AI execution engine (`create/update/delete`) with inverse-action undo, preview/manual apply gating, auto-mode immediate apply, and diff-based realtime/persistence commit path. Undo is invalidated on manual non-AI board mutations. Fix-forward removed hardcoded template expansion and added generic plan-quality logic in `/api/ai/generate`: stronger planning prompt + one self-correction pass when complex prompts return under-scoped tool plans. Added tool-input validation with one correction pass for malformed plans, added explicit `deleteObject` tool contract, and hardened executor fallback behavior for missing `createShape` dimensions (`line` also accepts `x2`/`y2`). UX fix-forward now disables Undo silently after manual invalidation (no error flash). Reliability fix-forward adds board-session wake pings to Render `/health` and keeps socket status in `connecting` during first cold-start retries. Deployed via `AhJ5s14VZzPmcuD9xxwQznGpijWa` on February 18, 2026 and aliased to `https://collab-board-iota.vercel.app`. |
| US2-04 | Uncommitted | https://collab-board-iota.vercel.app | https://collab-board-0948.onrender.com | lint pass, targeted US2-04 suites pass, full test pass (30 files/187 tests), build pass (Node warning only) | Added failing tests first for dedupe acceptance/replay rejection, stale-update ordering, concurrent AI convergence, and metrics rendering; then implemented to green | Pending | Ready for User Checkpoint | Added realtime metadata propagation (`txId`, `source`, `actorUserId`) end-to-end on object events, client-side dedupe cache with TTL/max-entry pruning, and AI multiplayer metrics (`AI apply avg`, `AI applies`, `AI dedupe drops`) in overlay. Preserved stale-event rejection via existing LWW logic and added server metadata extraction/rebroadcast helper for deterministic payload handling. Deployed via `FdjarYBVFnNfEXgpbTDQD6FsGsDC` on February 18, 2026 and aliased to `https://collab-board-iota.vercel.app`. |
| US2-05 | 39dc334 | https://collab-board-iota.vercel.app | https://collab-board-0948.onrender.com | lint pass, targeted US2-05 suites pass, full test pass (31 files/207 tests), build pass (Node 18 warning only) | Added failing tests first for access matrix resolver, landing returnTo routing, board read-only/redirect behavior, AI endpoint auth/permission checks, and create-board sharing defaults; then implemented to green | Pending | Ready for User Checkpoint | Implemented access resolver v2 (private/auth/public + owner/editor/viewer + legacy fallback), board-route access resolution with signed-out non-public redirect (`returnTo`), viewer read-only enforcement on canvas + AI controls, AI API bearer-token + board permission enforcement, and create-board defaults (`schemaVersion: 2`, private sharing). Remaining deployment actions: set Vercel Firebase Admin env vars (`FIREBASE_PROJECT_ID`, `FIREBASE_CLIENT_EMAIL`, `FIREBASE_PRIVATE_KEY`) so `/api/ai/generate` can verify tokens, and deploy Firestore rules from an authenticated Firebase CLI session (current CLI returns `HTTP 401 invalid authentication credentials`). |
| US2-06 | 7ac32b8 | https://collab-board-iota.vercel.app | https://collab-board-0948.onrender.com | lint pass, targeted US2-06 suites pass (22 tests), full test pass (33 files/217 tests), build pass (Node 18 warning only) | Added failing tests first for sharing panel owner/non-owner flows, required public-role validation, workspace-save behavior, and member role/remove writes, then implemented to green | Pending | Ready for User Checkpoint | Added full share side-panel UX on board with owner-only visibility/role controls, explicit public-link role requirement before save, collaborator `Save to workspace`, owner member role update/remove actions, and panel copy-link behavior. Added `useBoardSharing` hook + shared `types/sharing.ts`. Firestore rules hardened so non-owner editors cannot mutate board `sharing`, while signed-in users can self-save accessible boards into `boardMembers` only with non-owner role matching effective link role. Deployed to Vercel production alias on February 19, 2026. |
| US2-07 | 95aacaf | https://collab-board-iota.vercel.app | https://collab-board-0948.onrender.com | lint pass, targeted tests pass, full test pass (35 files/233 tests), build pass (Node warning only) | Added failing tests first for shared-tab activation, explicit/recent section rendering, open-card navigation, merge/dedupe sorting, recents upsert, partial-query failure fallback, and follow-up member name hydration/layout regressions; then implemented to green | Passed | Approved | Activated Shared with me dashboard tab, implemented `boardMembers` + `boardRecents` hybrid listing with explicit-first dedupe/sorting, integrated board open recents tracking, and added Firestore `boardRecents` rules. Fix-forward completed member display-name hydration from `users/{uid}` plus stable row layout in share panel. |
| US2-08 | Pending Signoff Commit | https://collab-board-iota.vercel.app | https://collab-board-0948.onrender.com | lint pass, full test pass (35 files/233 tests), build pass (Node/Vite version warning + chunk-size warning only) | US2-08 is validation/signoff story: no new defects found in local sweep, and prior story red->green evidence remains intact. Any production defects found in this checkpoint must follow failing-test-first fix-forward before sign-off. | Passed | Approved | Final validation matrix and production test script documented in `US2-08-phase2-validation-and-signoff.md`; production checkpoint executed and user-approved on February 19, 2026. |
| US2-09 | Pending | Pending | Pending | Pending | Pending | Pending | Deferred Backlog | Figma-grade connector parity follow-up (side-center and arbitrary attachment modes, hover lock, orthogonal routing, path handles, and connector styling/labels) captured in `US2-09-figma-connector-parity.md`. |
| US2-10 | Pending | Pending | Pending | Pending | Pending | Pending | Deferred Backlog | Board-level multi-step undo/redo follow-up (manual + AI transaction history, redo invalidation rules, and deterministic rollback/re-apply behavior) captured in `US2-10-board-history-undo-redo.md`. |
| US2-11 | Pending | Pending | Pending | Pending | Pending | Pending | Deferred Backlog | FigJam-style floating layout and contextual controls follow-up (top-left doc controls, bottom tool dock, right-side inspector, bottom-left zoom chip, and selection-aware style panels) captured in `US2-11-figjam-layout-and-contextual-controls.md`. |
